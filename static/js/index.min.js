!function (n) { "use strict"; var a = !1; n('a.js-scroll-trigger[href*="#"]:not([href="#"])').click(function () { if (location.pathname.replace(/^\//, "") == this.pathname.replace(/^\//, "") && location.hostname == this.hostname) { var a = n(this.hash); if ((a = a.length ? a : n("[name=" + this.hash.slice(1) + "]")).length) return n("html, body").animate({ scrollTop: a.offset().top - 54 }, 1e3, "easeInOutExpo"), !1 } }), n(".modal").on("shown.bs.modal", function (a) { n(".img-slider").resize() }), n(".js-scroll-trigger").click(function () { n(".navbar-collapse").collapse("hide") }), n("body").on("hidden.bs.modal", function () { 0 < n(".modal.in").length && n("body").addClass("modal-open") }), n(document).ready(function () { n(".modal").on("hidden.bs.modal", function (a) { n(".modal:visible").length && n("body").addClass("modal-open") }) }), n(document).ready(function () { n(document).on("show.bs.modal", ".modal", function (a) { var o = 1040 + 10 * n(".modal:visible").length; n(this).css("z-index", o), setTimeout(function () { n(".modal-backdrop").not(".modal-stack").css("z-index", o - 1).addClass("modal-stack") }, 0) }) }), n(".img-slider").slick("setPosition"), n("body").scrollspy({ target: "#mainNav", offset: 56 }); var o = function () { a = 250 < n(window).scrollTop() ? (a || n(".navbar").hide(), n("#mainNav").addClass("navbar-shrink"), n("#logo").addClass("logo-shrink"), n("#mainNav").removeClass("top"), n("#mainNav").addClass("fixed-top"), n(".navbar").fadeIn(300), !0) : (n("#mainNav").removeClass("navbar-shrink"), n("#logo").removeClass("logo-shrink"), n("#mainNav").removeClass("fixed-top"), n("#mainNav").addClass("top"), n(".navbar").show(), !1) }; n("#navbar-btn").click(function () { document.getElementById("mainNav").classList.contains("black-on-show") ? n("#mainNav").removeClass("black-on-show") : n("#mainNav").addClass("black-on-show") }), o(), n(window).scroll(o), n(".portfolio-modal").on("show.bs.modal", function (a) { n(".navbar").addClass("d-none") }), n(".portfolio-modal").on("hidden.bs.modal", function (a) { n(".navbar").removeClass("d-none") }); var s, e; s = { lat: -23.4960314, lng: 46.8878587 }, e = new google.maps.Map(document.getElementById("map"), { zoom: 17, center: s }), new google.maps.Marker({ position: s, map: e }) }(jQuery);

//função executada ao carregar a página, contém as funções que vão carregar os produtos e modais.
window.onload = function () {
    var produtos = getProd('/produtos');
    produtos = JSON.parse(produtos);
    console.log(produtos);
    for (produto in produtos) {
        this.addProduto(produtos[produto]);
        this.addModal(produtos[produto]);
    }
    //this.addAddButton();
};

//função responsável por fazer qualquer requisição GET ao banco de dados
function getProd(theUrl) {
    var xmlHttp = new XMLHttpRequest();
    xmlHttp.open("GET", theUrl, false); // false for synchronous request
    xmlHttp.send(null);
    return xmlHttp.responseText;
}

//adiciona cada produto na tela
function addProduto(produto) {
    div = document.createElement('div');
    div.className = 'col-md-4 col-sm-6 vidros-item';
    div.id = produto.id

    div.innerHTML = `
        <a class="vidros-link" data-toggle="modal" href="#produtoModal`+ produto.id + `">
            <div class="vidros-hover">
                <div class="vidros-hover-content">
                    <i class="fas fa-search-plus fa-3x"></i>
                </div>
            </div>
            <img class="img-fluid fit-image" src="`+ produto.imagem + `" alt="">
        </a>
        <div class="vidros-caption">
            <h4>`+ produto.titulo + `</h4>
        </div>
        
    `;

    document.getElementById('getProdutos').appendChild(div);
}

//cada produto abre um modal que contém várias imagens, essa função adiciona o modal de cada produto
function addModal(produto) {
    const div = document.createElement('div');
    div.innerHTML = `
    <div class="vidros-modal modal fade" id="produtoModal`+ produto.id + `" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="close-modal" data-dismiss="modal">
            <i class="fas fa-times externo"></i>
        </div>
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="container">
                    <div class="modal-body modal-reduce-width">
                        <h2 class="text-uppercase">`+ produto.titulo + `</h2>
                        <img class="img-fluid d-block mx-auto vidros-moldura" src="`+ produto.imagem + `" alt="">
                        <p>`+ produto.texto + `</p>
                        <button class="btn btn-primary" data-dismiss="modal" type="button">
                            <i class="fas fa-times"></i>
                            Fechar</button>
                    </div>

                </div>
            </div>
        </div>
    </div>
    `
    document.getElementById('getModal').appendChild(div);
}